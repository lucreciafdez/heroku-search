import _defineProperty from "@babel/runtime/helpers/defineProperty";
import _objectWithoutProperties from "@babel/runtime/helpers/objectWithoutProperties";

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

import SearchDriver from "../SearchDriver";
var suggestions = {
  documents: [{
    suggestion: "carlsbad"
  }, {
    suggestion: "carlsbad caverns"
  }, {
    suggestion: "carolina"
  }]
};
var searchResponse = {
  totalResults: 1000,
  totalPages: 100,
  requestId: "12345",
  facets: {},
  results: [{}, {}]
};
var autocompleteSearchResponse = {
  requestId: "6789",
  results: [{}, {}]
};
export function getMockApiConnector() {
  return {
    onAutocomplete: jest.fn().mockReturnValue({
      then: function then(cb) {
        return cb({
          autocompletedResults: autocompleteSearchResponse.results,
          autocompletedResultsRequestId: autocompleteSearchResponse.requestId,
          autocompletedSuggestions: suggestions
        });
      }
    }),
    onSearch: jest.fn().mockReturnValue({
      then: function then(cb) {
        return cb(searchResponse);
      }
    }),
    onResultClick: jest.fn().mockReturnValue({
      then: function then() {}
    }),
    onAutocompleteResultClick: jest.fn().mockReturnValue({
      then: function then() {}
    })
  };
}
export function setupDriver() {
  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
      mockSearchResponse = _ref.mockSearchResponse,
      rest = _objectWithoutProperties(_ref, ["mockSearchResponse"]);

  var mockApiConnector = getMockApiConnector();

  if (mockSearchResponse) {
    mockApiConnector.onSearch = jest.fn().mockReturnValue({
      then: function then(cb) {
        return cb(mockSearchResponse);
      }
    });
  }

  var driver = new SearchDriver(_objectSpread({
    apiConnector: mockApiConnector
  }, rest, {
    // We don't want to deal with async in our tests, so pass 0 so URL state
    // pushes happen synchronously
    urlPushDebounceLength: 0
  }));
  var updatedStateAfterAction = {};
  driver.subscribeToStateChanges(function (newState) {
    updatedStateAfterAction.state = newState;
  });
  jest.runAllTimers();
  return {
    stateAfterCreation: driver.getState(),
    driver: driver,
    updatedStateAfterAction: updatedStateAfterAction,
    mockApiConnector: mockApiConnector
  };
}
export function doesStateHaveResponseData(response) {
  var requestId = response.requestId,
      results = response.results,
      totalPages = response.totalPages,
      totalResults = response.totalResults,
      wasSearched = response.wasSearched;
  return !!results && results.length && !!requestId && totalPages > 0 && totalResults > 0 && !!wasSearched;
}
export function getSearchCalls(mockApiConnector) {
  return mockApiConnector.onSearch.mock.calls;
}
export function getAutocompleteCalls(mockApiConnector) {
  return mockApiConnector.onAutocomplete.mock.calls;
}
export function getClickCalls(mockApiConnector) {
  return mockApiConnector.onResultClick.mock.calls;
}
export function getAutocompleteClickCalls(mockApiConnector) {
  return mockApiConnector.onAutocompleteResultClick.mock.calls;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0L2hlbHBlcnMuanMiXSwibmFtZXMiOlsiU2VhcmNoRHJpdmVyIiwic3VnZ2VzdGlvbnMiLCJkb2N1bWVudHMiLCJzdWdnZXN0aW9uIiwic2VhcmNoUmVzcG9uc2UiLCJ0b3RhbFJlc3VsdHMiLCJ0b3RhbFBhZ2VzIiwicmVxdWVzdElkIiwiZmFjZXRzIiwicmVzdWx0cyIsImF1dG9jb21wbGV0ZVNlYXJjaFJlc3BvbnNlIiwiZ2V0TW9ja0FwaUNvbm5lY3RvciIsIm9uQXV0b2NvbXBsZXRlIiwiamVzdCIsImZuIiwibW9ja1JldHVyblZhbHVlIiwidGhlbiIsImNiIiwiYXV0b2NvbXBsZXRlZFJlc3VsdHMiLCJhdXRvY29tcGxldGVkUmVzdWx0c1JlcXVlc3RJZCIsImF1dG9jb21wbGV0ZWRTdWdnZXN0aW9ucyIsIm9uU2VhcmNoIiwib25SZXN1bHRDbGljayIsIm9uQXV0b2NvbXBsZXRlUmVzdWx0Q2xpY2siLCJzZXR1cERyaXZlciIsIm1vY2tTZWFyY2hSZXNwb25zZSIsInJlc3QiLCJtb2NrQXBpQ29ubmVjdG9yIiwiZHJpdmVyIiwiYXBpQ29ubmVjdG9yIiwidXJsUHVzaERlYm91bmNlTGVuZ3RoIiwidXBkYXRlZFN0YXRlQWZ0ZXJBY3Rpb24iLCJzdWJzY3JpYmVUb1N0YXRlQ2hhbmdlcyIsIm5ld1N0YXRlIiwic3RhdGUiLCJydW5BbGxUaW1lcnMiLCJzdGF0ZUFmdGVyQ3JlYXRpb24iLCJnZXRTdGF0ZSIsImRvZXNTdGF0ZUhhdmVSZXNwb25zZURhdGEiLCJyZXNwb25zZSIsIndhc1NlYXJjaGVkIiwibGVuZ3RoIiwiZ2V0U2VhcmNoQ2FsbHMiLCJtb2NrIiwiY2FsbHMiLCJnZXRBdXRvY29tcGxldGVDYWxscyIsImdldENsaWNrQ2FsbHMiLCJnZXRBdXRvY29tcGxldGVDbGlja0NhbGxzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsT0FBT0EsWUFBUCxNQUF5QixpQkFBekI7QUFFQSxJQUFNQyxXQUFXLEdBQUc7QUFD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QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTZWFyY2hEcml2ZXIgZnJvbSBcIi4uL1NlYXJjaERyaXZlclwiO1xuXG5jb25zdCBzdWdnZXN0aW9ucyA9IHtcbiAgZG9jdW1lbnRzOiBbXG4gICAge1xuICAgICAgc3VnZ2VzdGlvbjogXCJjYXJsc2JhZFwiXG4gICAgfSxcbiAgICB7XG4gICAgICBzdWdnZXN0aW9uOiBcImNhcmxzYmFkIGNhdmVybnNcIlxuICAgIH0sXG4gICAge1xuICAgICAgc3VnZ2VzdGlvbjogXCJjYXJvbGluYVwiXG4gICAgfVxuICBdXG59O1xuXG5jb25zdCBzZWFyY2hSZXNwb25zZSA9IHtcbiAgdG90YWxSZXN1bHRzOiAxMDAwLFxuICB0b3RhbFBhZ2VzOiAxMDAsXG4gIHJlcXVlc3RJZDogXCIxMjM0NVwiLFxuICBmYWNldHM6IHt9LFxuICByZXN1bHRzOiBbe30sIHt9XVxufTtcblxuY29uc3QgYXV0b2NvbXBsZXRlU2VhcmNoUmVzcG9uc2UgPSB7XG4gIHJlcXVlc3RJZDogXCI2Nzg5XCIsXG4gIHJlc3VsdHM6IFt7fSwge31dXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9ja0FwaUNvbm5lY3RvcigpIHtcbiAgcmV0dXJuIHtcbiAgICBvbkF1dG9jb21wbGV0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB0aGVuOiBjYiA9PlxuICAgICAgICBjYih7XG4gICAgICAgICAgYXV0b2NvbXBsZXRlZFJlc3VsdHM6IGF1dG9jb21wbGV0ZVNlYXJjaFJlc3BvbnNlLnJlc3VsdHMsXG4gICAgICAgICAgYXV0b2NvbXBsZXRlZFJlc3VsdHNSZXF1ZXN0SWQ6IGF1dG9jb21wbGV0ZVNlYXJjaFJlc3BvbnNlLnJlcXVlc3RJZCxcbiAgICAgICAgICBhdXRvY29tcGxldGVkU3VnZ2VzdGlvbnM6IHN1Z2dlc3Rpb25zXG4gICAgICAgIH0pXG4gICAgfSksXG4gICAgb25TZWFyY2g6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoeyB0aGVuOiBjYiA9PiBjYihzZWFyY2hSZXNwb25zZSkgfSksXG4gICAgb25SZXN1bHRDbGljazogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7IHRoZW46ICgpID0+IHt9IH0pLFxuICAgIG9uQXV0b2NvbXBsZXRlUmVzdWx0Q2xpY2s6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoeyB0aGVuOiAoKSA9PiB7fSB9KVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBEcml2ZXIoeyBtb2NrU2VhcmNoUmVzcG9uc2UsIC4uLnJlc3QgfSA9IHt9KSB7XG4gIGNvbnN0IG1vY2tBcGlDb25uZWN0b3IgPSBnZXRNb2NrQXBpQ29ubmVjdG9yKCk7XG5cbiAgaWYgKG1vY2tTZWFyY2hSZXNwb25zZSkge1xuICAgIG1vY2tBcGlDb25uZWN0b3Iub25TZWFyY2ggPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIHRoZW46IGNiID0+IGNiKG1vY2tTZWFyY2hSZXNwb25zZSlcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGRyaXZlciA9IG5ldyBTZWFyY2hEcml2ZXIoe1xuICAgIGFwaUNvbm5lY3RvcjogbW9ja0FwaUNvbm5lY3RvcixcbiAgICAvLyBQYXNzLCBlLmcuLCBpbml0aWFsU3RhdGUgYW5kIGFsbCBvdGhlciBjb25maWdzXG4gICAgLi4ucmVzdCxcbiAgICAvLyBXZSBkb24ndCB3YW50IHRvIGRlYWwgd2l0aCBhc3luYyBpbiBvdXIgdGVzdHMsIHNvIHBhc3MgMCBzbyBVUkwgc3RhdGVcbiAgICAvLyBwdXNoZXMgaGFwcGVuIHN5bmNocm9ub3VzbHlcbiAgICB1cmxQdXNoRGVib3VuY2VMZW5ndGg6IDBcbiAgfSk7XG5cbiAgY29uc3QgdXBkYXRlZFN0YXRlQWZ0ZXJBY3Rpb24gPSB7fTtcbiAgZHJpdmVyLnN1YnNjcmliZVRvU3RhdGVDaGFuZ2VzKG5ld1N0YXRlID0+IHtcbiAgICB1cGRhdGVkU3RhdGVBZnRlckFjdGlvbi5zdGF0ZSA9IG5ld1N0YXRlO1xuICB9KTtcblxuICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuXG4gIHJldHVybiB7XG4gICAgc3RhdGVBZnRlckNyZWF0aW9uOiBkcml2ZXIuZ2V0U3RhdGUoKSxcbiAgICBkcml2ZXIsXG4gICAgdXBkYXRlZFN0YXRlQWZ0ZXJBY3Rpb24sXG4gICAgbW9ja0FwaUNvbm5lY3RvclxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZG9lc1N0YXRlSGF2ZVJlc3BvbnNlRGF0YShyZXNwb25zZSkge1xuICBjb25zdCB7XG4gICAgcmVxdWVzdElkLFxuICAgIHJlc3VsdHMsXG4gICAgdG90YWxQYWdlcyxcbiAgICB0b3RhbFJlc3VsdHMsXG4gICAgd2FzU2VhcmNoZWRcbiAgfSA9IHJlc3BvbnNlO1xuICByZXR1cm4gKFxuICAgICEhcmVzdWx0cyAmJlxuICAgIHJlc3VsdHMubGVuZ3RoICYmXG4gICAgISFyZXF1ZXN0SWQgJiZcbiAgICB0b3RhbFBhZ2VzID4gMCAmJlxuICAgIHRvdGFsUmVzdWx0cyA+IDAgJiZcbiAgICAhIXdhc1NlYXJjaGVkXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZWFyY2hDYWxscyhtb2NrQXBpQ29ubmVjdG9yKSB7XG4gIHJldHVybiBtb2NrQXBpQ29ubmVjdG9yLm9uU2VhcmNoLm1vY2suY2FsbHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdXRvY29tcGxldGVDYWxscyhtb2NrQXBpQ29ubmVjdG9yKSB7XG4gIHJldHVybiBtb2NrQXBpQ29ubmVjdG9yLm9uQXV0b2NvbXBsZXRlLm1vY2suY2FsbHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGlja0NhbGxzKG1vY2tBcGlDb25uZWN0b3IpIHtcbiAgcmV0dXJuIG1vY2tBcGlDb25uZWN0b3Iub25SZXN1bHRDbGljay5tb2NrLmNhbGxzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXV0b2NvbXBsZXRlQ2xpY2tDYWxscyhtb2NrQXBpQ29ubmVjdG9yKSB7XG4gIHJldHVybiBtb2NrQXBpQ29ubmVjdG9yLm9uQXV0b2NvbXBsZXRlUmVzdWx0Q2xpY2subW9jay5jYWxscztcbn1cbiJdfQ==